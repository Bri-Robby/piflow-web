<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<body th:fragment=process_List>
<meta th:include="/Macro/csrfTokeHeadMacro :: csrfTokeHeadMacro"/>
<link th:src="@{/bootstrap/js/bootstrap-table.css}"></link>
<style type="text/css">
    /*人为制造一个占据整个屏幕的Div,其透明度为0.7且z-index为9999使之前的页面被压在底层无法点击*/
    .fullScreenList {
        position: fixed;
        width: 100%;
        height: 100%;
        left: 0;
        top: 0;
        opacity: 0.7;
        background-color: black;
        z-index: 9999;
        text-align: center;
    }
</style>
<script th:src="@{/charisma/js/layer/layer.js}"></script>
<!-- content starts -->
<div class="wrapper" style="margin: 20px;">
    <!-- Search widget -->
    <!--
    <form class="search widget" action="#">
        <div class="autocomplete-append">
            <ul class="search-options">
                <li><a href="#" title="Go to search page" class="go-option tip"></a></li>
                <li><a href="#" title="Advanced search" class="advanced-option tip"></a></li>
                <li><a href="#" title="Settings" class="settings-option tip"></a></li>
            </ul>
            <input type="text" placeholder="search website..." id="autocomplete"/>
            <input type="submit" class="btn btn-info" value="Search"/>
        </div>
    </form>
    -->
    <!-- /search widget -->
    <!-- Media datatable -->
    <div class="widget">
        <div class="navbar">
            <div class="navbar-inner">
                <h6>Process List</h6>
            </div>
        </div>
        <div class="table-overflow">
            <table class="table table-striped table-bordered table-checks media-table">
                <thead>
                <tr>
                    <th style="display: none">No</th>
                    <th>ProcessID</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>StartTime</th>
                    <th>EndTime</th>
                    <th>Progress</th>
                    <th>State</th>
                    <th class="actions-column">Actions</th>
                </tr>
                </thead>
                <tbody th:unless="${processVoList}">
                </tbody>
                <tbody th:if="${processVoList}">
                <tr th:each='processVo:${processVoList}'>
                    <td class="center" style="display: none" th:text="${processVoStat.index}"></td>
                    <td class="center" name="processAppId" th:text="${processVo.appId}"></td>
                    <td class="center" th:text="${processVo.name}"></td>
                    <td class="center">
                        <div style="width: 85px;overflow: hidden;text-overflow:ellipsis;white-space:nowrap;"
                             data-toggle="tooltip" data-placement="top" th:title="${processVo.description}"
                             th:text="${processVo.description}">
                        </div>
                    </td>
                    <td name="processStartTime"
                        th:text="${#dates.format(processVo.startTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
                    <td th:text="${#dates.format(processVo.endTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
                    <td class="center">
                        <div id='d'>
                            <p th:id='${processVo.id}+Info'
                               th:text="${processVo.progress}?'progress:'+${processVo.progress}+'%':'progressprogress:0%'"></p>
                            <progress th:id='${processVo.id}' max='100'
                                      th:value="${processVo.progress}"></progress>
                        </div>
                    </td>
                    <td name="processState" class="center"
                        th:text="${processVo.state}?${processVo.state}:'No state'"
                        th:id='${processVo.id}+state'></td>
                    <td class="center" style="white-space: nowrap;">
                        <a class="btn"
                           th:href="'/piflow-web/process/getProcessById?processId='+${processVo.id}+''"
                           target="_blank" style="background-color: #C0C0C0;border: 1px solid;color: #6b5555;">
                            <i class="icon-share-alt icon-white"></i>
                        </a>
                        <a class="btn" href="javascript:void(0);"
                           style="background-color: #C0C0C0;border: 1px solid;color: #6b5555;"
                           th:onclick="'javascript:getCheckpointList(\''+${processVo.id}+'\',\''+${processVo.processId}+'\',\''+${processVo.parentProcessId}+'\');'">
                            <i class="icon-play icon-white"></i>
                        </a>
                        <a class="btn" href="javascript:void(0);"
                           style="background-color: #C0C0C0;border: 1px solid;color: #6b5555;"
                           th:onclick="'javascript:stopProcess(\''+${processVo.id}+'\');'">
                            <i class="icon-stop icon-white"></i>
                        </a>
                        <a class="btn" href="javascript:void(0);"
                           style="background-color: #C0C0C0;border: 1px solid;color: #6b5555;"
                           th:onclick="'javascript:delProcess(\''+${processVo.id}+'\');'">
                            <i class="icon-trash icon-white"></i>
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>
            <br>
            <div>
                <span>------------------------------------------------------------------------------------------------</span>
                <div>
                    <table id="testTableId">
                    </table>
                </div>
                <div id="toolbar" class="btn-group">
                    <button id="btn_add" type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
                    </button>
                    <button id="btn_edit" type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改
                    </button>
                    <button id="btn_delete" type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- /media datatable -->
</div>
<!-- content ends -->
<!-- Modal Checkpoint -->
<!-- Modal Checkpoint -->
<div class="modal" id="checkpointListShow" aria-labelledby="myModalLabel" data-backdrop="static"
     style="z-index: 10000; display: none">
    <div id="modalDialogPort" class="modal-dialog" role="document">
        <div class="modal-content" style="width: 100%;  top: 77px;">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabelPort">CHOOSE CHECKPOINT WINDOWS</h4>
            </div>
            <div id="checkpointListContent" class="modal-body">
                Did not find checkpoint information
                <input type="checkbox" value="">
            </div>
            <div class="modal-footer">
                <button id="runProcessBtn" type="button" class="btn btn-default">Run</button>
                <button id="stopProcessBtn" type="button" class="btn btn-default">Cancel</button>
            </div>
        </div>
    </div>
</div>
<div id='fullScreenList' class="fullScreenList" style="display: none;">
    <div style="margin-top: 15%;">
        <p>
            <img th:src="@{/img/fullScreen.gif}" alt="">
        </p>
    </div>
    `
</div>
<script th:include="/Macro/csrfTokeHeadMacroScript :: csrfTokeHeadMacroScript"/>
<script th:src="@{/custom/processList.js}"></script>
<script th:src="@{/bootstrap/js/bootstrap-table.js}"></script>
<script th:inline="javascript">
    $(function () {
        timer = window.setInterval("processListMonitoring()", 5000);
        var tableColumns = [
            {
                checkbox: true
            }, {
                align: "center",
                halign: "center",
                valign: "middle",
                field: 'index',
                title: 'No'
            }, {
                align: "center",
                halign: "center",
                valign: "middle",
                field: 'appId',
                title: 'ProcessID'
            }, {
                align: "center",
                halign: "center",
                valign: "middle",
                field: 'name',
                title: 'Name'
            }];

        //初始化表格
        TableInit('testTableId', '/piflow-web/process/processLists', tableColumns);
    });
    //@ sourceURL=processList0.js
</script>
</body>
</html>