<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment=process_Checkpoint_Inc>
    <div id="checkpointsContentDiv">
        <input id="checkpointsIsNull" style="display: none" value="isNull"/>
    </div>
    <div th:if="${checkpointsSplit}">
            <span th:each=" checkpoint : ${checkpointsSplit}">
                <input type="checkbox" th:value="${checkpoint}"/>
                <span th:text="${checkpoint}"></span>
                </br>
            </span>
    </div>
</div>
<script th:inline="javascript">
    var pID = [[${pID}]];
    var parentProcessId = [[${parentProcessId}]];

    function initProcessCheckpointIncPageData(pID, parentProcessId) {
        $.ajax({
            cache: true,//Keep cached data
            type: "get",//Request for get
            url: "/piflow-web/process/getCheckpointData",//This is the name of the file where I receive data in the background.
            //data:$('#loginForm').serialize(),//Serialize the form
            data: {
                pID: pID,
                parentProcessId: parentProcessId,
            },
            async: true,//Setting it to true indicates that other code can still be executed after the request has started. If this option is set to false, it means that all requests are no longer asynchronous, which also causes the browser to be locked.
            error: function (request) {//Operation after request failure
                alert("Request Failed");
                return;
            },
            success: function (data) {//Operation after request successful
                var dataMap = JSON.parse(data);
                if (200 === dataMap.code) {
                    var checkpointsSplitArray = dataMap.checkpointsSplit;
                    if (checkpointsSplitArray) {
                        var ss = "";
                        for (var i = 0; i < checkpointsSplitArray.length; i++) {
                            ss += ('<span>'
                                + '<input type="checkbox" th:value="' + checkpointsSplitArray[i] + '"/>'
                                + '<span>' + checkpointsSplitArray[i] + '</span>'
                                + '</br>'
                                + '</span>');
                        }
                    }
                }
                $('#fullScreen').hide();
            }
        });
    }

    $(document).ready(function () {
        initProcessCheckpointIncPageData(pID, parentProcessId);
    });
</script>
</body>
</html>
